# libudon

High-performance UDON parser in Rust.

## What is UDON?

UDON (Universal Document & Object Notation) is a unified notation for documents, data, and configuration. See the [specification](https://github.com/josephwecker/udon) for details.

## Status

**Active rewrite using [descent](https://github.com/josephwecker/descent)** - a parser generator that produces callback-based recursive descent parsers.

Working:
- Elements with identity (`|element[id].class1.class2`)
- Sameline and block attributes (`:key value`)
- Typed values (integers, floats, booleans, nil, strings)
- Text/prose content
- Indentation hierarchy and nesting

See [PLAN.md](PLAN.md) for current progress and roadmap.

## Structure

```
libudon/
├── udon-core/           # Core parser library
│   └── src/
│       ├── lib.rs       # Public API
│       ├── parser.rs    # GENERATED by descent
│       └── span.rs      # Source locations
├── generator/           # Parser specification
│   ├── udon.desc        # Main parser grammar
│   └── values.desc      # Value type parsing
└── regenerate-parser    # Script to regenerate parser
```

## Building

```bash
cargo build --release
```

## Testing

```bash
cargo test
```

## Regenerating the Parser

The parser is generated from `.desc` specifications using descent:

```bash
# Install descent (from ~/src/descent/)
cd ~/src/descent && dx gem install

# Regenerate parser
./regenerate-parser
```

## Usage (Rust)

```rust
use udon_core::Parser;

let input = b"|article[intro]\n  :author Joseph\n  Hello, world!\n";

Parser::new(input).parse(|event| {
    println!("{}", event.format_line());
});
```

Output:
```
ElementStart @ 1..1
Name "article" @ 1..8
Attr "id" @ 8..15
BareValue "intro" @ 9..14
Attr "author" @ 19..25
BareValue "Joseph" @ 27..33
Text "Hello, world!" @ 36..49
ElementEnd @ 50..50
```

## Related Repositories

- [udon](https://github.com/josephwecker/udon) - Specification and examples
- [descent](https://github.com/josephwecker/descent) - Parser generator
- [udon-ruby](https://github.com/josephwecker/udon-ruby) - Ruby gem (needs update)

## License

MIT
