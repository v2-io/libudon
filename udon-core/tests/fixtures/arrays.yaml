---
# Array tests - [value value ...] syntax in attribute values

- id: simple_array
  desc: Simple array of bare strings
  udon: "|foo\n  :tags [a b c]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "tags"]
    - ArrayStart
    - [BareValue, "a"]
    - [BareValue, "b"]
    - [BareValue, "c"]
    - ArrayEnd
    - ElementEnd

- id: array_with_integers
  desc: Array with integer values
  udon: "|foo\n  :nums [1 2 3]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "nums"]
    - ArrayStart
    - [Integer, "1"]
    - [Integer, "2"]
    - [Integer, "3"]
    - ArrayEnd
    - ElementEnd

- id: array_with_quoted_strings
  desc: Array with quoted strings
  udon: "|foo\n  :names [\"Alice\" \"Bob\"]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "names"]
    - ArrayStart
    - [StringValue, "Alice"]
    - [StringValue, "Bob"]
    - ArrayEnd
    - ElementEnd

- id: nested_array
  desc: Nested arrays
  udon: "|foo\n  :matrix [[1 2] [3 4]]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "matrix"]
    - ArrayStart
    - ArrayStart
    - [Integer, "1"]
    - [Integer, "2"]
    - ArrayEnd
    - ArrayStart
    - [Integer, "3"]
    - [Integer, "4"]
    - ArrayEnd
    - ArrayEnd
    - ElementEnd

- id: empty_array
  desc: Empty array
  udon: "|foo\n  :items []\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "items"]
    - ArrayStart
    - ArrayEnd
    - ElementEnd
- id: deeply_nested_arrays_5_levels
  desc: deeply nested arrays 5 levels
  udon: "|foo\n  :deep [[[[[1]]]]]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "deep"]
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - [Integer, "1"]
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ElementEnd

- id: deeply_nested_empty_arrays
  desc: deeply nested empty arrays
  udon: "|foo\n  :empty [[[[[]]]]]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "empty"]
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ElementEnd

- id: mixed_nesting_with_values_at_each_level
  desc: mixed nesting with values at each level
  udon: "|foo\n  :mix [1 [2 [3 [4 [5]]] 6] 7]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "mix"]
    - ArrayStart
    - [Integer, "1"]
    - ArrayStart
    - [Integer, "2"]
    - ArrayStart
    - [Integer, "3"]
    - ArrayStart
    - [Integer, "4"]
    - ArrayStart
    - [Integer, "5"]
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - [Integer, "6"]
    - ArrayEnd
    - [Integer, "7"]
    - ArrayEnd
    - ElementEnd

- id: array_with_all_value_types
  desc: array with all value types (includes quoted string)
  udon: "|foo\n  :types [42 3.14 true false null \"quoted\" bare]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "types"]
    - ArrayStart
    - [Integer, "42"]
    - [Float, "3.14"]
    - BoolTrue
    - BoolFalse
    - Nil
    - [StringValue, "quoted"]
    - [BareValue, "bare"]
    - ArrayEnd
    - ElementEnd

- id: array_siblings_at_multiple_levels
  desc: array siblings at multiple levels
  udon: "|foo\n  :grid [[a b] [c d] [e f]]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "grid"]
    - ArrayStart
    - ArrayStart
    - [BareValue, "a"]
    - [BareValue, "b"]
    - ArrayEnd
    - ArrayStart
    - [BareValue, "c"]
    - [BareValue, "d"]
    - ArrayEnd
    - ArrayStart
    - [BareValue, "e"]
    - [BareValue, "f"]
    - ArrayEnd
    - ArrayEnd
    - ElementEnd

- id: array_with_quoted_strings_containing_brackets
  desc: array with quoted strings containing brackets
  udon: "|foo\n  :tricky [\"[not an array]\" \"]\" \"[\"]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "tricky"]
    - ArrayStart
    - [StringValue, "[not an array]"]
    - [StringValue, "]"]
    - [StringValue, "["]
    - ArrayEnd
    - ElementEnd

- id: complex_nested_structure
  desc: complex nested structure
  udon: "|foo\n  :cube [[[1 2] [3 4]] [[5 6] [7 8]]]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "cube"]
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - [Integer, "1"]
    - [Integer, "2"]
    - ArrayEnd
    - ArrayStart
    - [Integer, "3"]
    - [Integer, "4"]
    - ArrayEnd
    - ArrayEnd
    - ArrayStart
    - ArrayStart
    - [Integer, "5"]
    - [Integer, "6"]
    - ArrayEnd
    - ArrayStart
    - [Integer, "7"]
    - [Integer, "8"]
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ElementEnd

- id: array_with_single_quoted_strings
  desc: array with single quoted strings
  udon: "|foo\n  :names ['Alice' 'Bob']\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "names"]
    - ArrayStart
    - [StringValue, "Alice"]
    - [StringValue, "Bob"]
    - ArrayEnd
    - ElementEnd

# Multiline arrays - newlines separate items just like spaces (SPEC 325-329)
- id: array_multiline
  desc: array multiline
  udon: "|foo\n  :items [\n    a\n    b\n    c\n  ]\n"
  events:
    # Per SPEC 325: Terminators for array items are \n, SPACE, or ]
    # Newlines act as item separators, leading spaces on each line are skipped
    - ElementStart
    - [Name, "foo"]
    - [Attr, "items"]
    - ArrayStart
    - [BareValue, "a"]
    - [BareValue, "b"]
    - [BareValue, "c"]
    - ArrayEnd
    - ElementEnd

- id: empty_arrays_at_various_depths
  desc: empty arrays at various depths
  udon: "|foo\n  :empties [[] [[]] [[[]]]]\n"
  events:
    - ElementStart
    - [Name, "foo"]
    - [Attr, "empties"]
    - ArrayStart
    - ArrayStart
    - ArrayEnd
    - ArrayStart
    - ArrayStart
    - ArrayEnd
    - ArrayEnd
    - ArrayStart
    - ArrayStart
    - ArrayStart
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ArrayEnd
    - ElementEnd
